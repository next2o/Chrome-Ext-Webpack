chrome.tabs.onActivated.addListener((async e=>{const t=await chrome.tabs.get(e.tabId);let o;if(/^(https?|chrome):\/\//i.test(t.url)||(t.url=`https://${t.url}`,console.log("currentTab.url>>"+t.url)),!/^(http:\/\/|https:\/\/|chrome:\/\/|about:|data:|javascript:|chrome-extension:|chrome-devtools:|moz-extension:|moz-extension:|ms-browser-extension:).*$/.test(t.url))return void console.log("this is an internal page");try{o=new URL(t.url),console.log("currentTabURL>>"+o)}catch(e){return console.log(`Failed to construct URL: ${e}`),void console.log(t.url)}const r=o.href;chrome.cookies.get({url:r,name:"userId"},(e=>{let t;t=e?e.value:Math.floor(1e6*Math.random()).toString();const o=new Date(Date.now()+15778476e3);chrome.cookies.set({url:r,name:"userId",value:t,httpOnly:!0,expirationDate:o.getTime()/1e3})})),chrome.cookies.get({url:r,name:"userId"},(e=>{console.log(e)}))}));